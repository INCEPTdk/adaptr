<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Plots the history of relevant metrics over the progress of single or multiple
simulations. Simulated trials only contribute until the time they are
stopped, i.e., if some trials are stopped earlier than others, they will not
contribute to the summary statistics at later adaptive looks. Data from
individual arms in a trial contribute until the complete trial is stopped.
These history plots require non-sparse results (sparse set to
FALSE; see run_trial() and run_trials()) and the ggplot2 package
installed."><title>Plot trial metric history — plot_history • adaptr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot trial metric history — plot_history"><meta property="og:description" content="Plots the history of relevant metrics over the progress of single or multiple
simulations. Simulated trials only contribute until the time they are
stopped, i.e., if some trials are stopped earlier than others, they will not
contribute to the summary statistics at later adaptive looks. Data from
individual arms in a trial contribute until the complete trial is stopped.
These history plots require non-sparse results (sparse set to
FALSE; see run_trial() and run_trials()) and the ggplot2 package
installed."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">adaptr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Advanced-example.html">Advanced example</a>
    <a class="dropdown-item" href="../articles/Basic-examples.html">Basic examples</a>
    <a class="dropdown-item" href="../articles/Overview.html">Overview</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/INCEPTdk/adaptr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Plot trial metric history</h1>
      <small class="dont-index">Source: <a href="https://github.com/INCEPTdk/adaptr/blob/HEAD/R/plot_history.R" class="external-link"><code>R/plot_history.R</code></a></small>
      <div class="d-none name"><code>plot_history.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plots the history of relevant metrics over the progress of single or multiple
simulations. Simulated trials <strong>only</strong> contribute until the time they are
stopped, i.e., if some trials are stopped earlier than others, they will not
contribute to the summary statistics at later adaptive looks. Data from
individual arms in a trial contribute until the complete trial is stopped.<br>
These history plots require non-sparse results (<code>sparse</code> set to
<code>FALSE</code>; see <code><a href="run_trial.html">run_trial()</a></code> and <code><a href="run_trials.html">run_trials()</a></code>) and the <code>ggplot2</code> package
installed.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">plot_history</span><span class="op">(</span><span class="va">object</span>, x_value <span class="op">=</span> <span class="st">"look"</span>, y_value <span class="op">=</span> <span class="st">"prob"</span>, line <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for trial_result</span>
<span class="fu">plot_history</span><span class="op">(</span><span class="va">object</span>, x_value <span class="op">=</span> <span class="st">"look"</span>, y_value <span class="op">=</span> <span class="st">"prob"</span>, line <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for trial_results</span>
<span class="fu">plot_history</span><span class="op">(</span>
  <span class="va">object</span>,
  x_value <span class="op">=</span> <span class="st">"look"</span>,
  y_value <span class="op">=</span> <span class="st">"prob"</span>,
  line <span class="op">=</span> <span class="cn">NULL</span>,
  ribbon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.5</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p><code>trial_results</code> object, output from the <code><a href="run_trials.html">run_trials()</a></code>
function.</p></dd>


<dt>x_value</dt>
<dd><p>single character string, determining whether the number of
adaptive analysis looks (<code>"look"</code>, default) or the total cumulated number of
patients allocated (<code>"total n"</code>) are plotted on the x-axis.</p></dd>


<dt>y_value</dt>
<dd><p>single character string, determining which values are plotted
on the y-axis. The following options are available: allocation
probabilities (<code>"prob"</code>, default), the total number of patients allocated
to each arm (<code>"n"</code>), the percentage of patients allocated to each arm of
the total number of patients randomised (<code>"pct"</code>), the sum of all outcomes
in each arm (<code>"sum ys"</code>), the ratio of outcomes (<code>"ratio ys"</code>, the sum of
outcomes in each arm divided by the number of patients allocated to that
arm).</p></dd>


<dt>line</dt>
<dd><p>list styling the lines as per <span class="pkg">ggplot2</span> conventions (e.g.,
<code>linetype</code>, <code>size</code>).</p></dd>


<dt>...</dt>
<dd><p>additional arguments, not used.</p></dd>


<dt>ribbon</dt>
<dd><p>list, as <code>line</code> but only appropriate for <code>trial_results</code>
objects (i.e., when multiple simulations are run). Also allows to specify
the <code>width</code> of the interval: must be between 0 and 1, with <code>0.5</code> (default)
showing the inter-quartile ranges.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A <code>ggplot2</code> plot object.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="plot_status.html">plot_status()</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">#### Only run examples if ggplot2 is installed ####</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"ggplot2"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Setup a trial specification</span></span>
<span class="r-in">  <span class="va">binom_trial</span> <span class="op">&lt;-</span> <span class="fu"><a href="setup_trial_binom.html">setup_trial_binom</a></span><span class="op">(</span>arms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span><span class="op">)</span>,</span>
<span class="r-in">                                   control <span class="op">=</span> <span class="st">"A"</span>,</span>
<span class="r-in">                                   true_ys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.20</span>, <span class="fl">0.18</span>, <span class="fl">0.22</span>, <span class="fl">0.24</span><span class="op">)</span>,</span>
<span class="r-in">                                   data_looks <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Run a single simulation with a fixed random seed</span></span>
<span class="r-in">  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="run_trial.html">run_trial</a></span><span class="op">(</span><span class="va">binom_trial</span>, seed <span class="op">=</span> <span class="fl">12345</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Plot total allocations to each arm according to overall total allocations</span></span>
<span class="r-in">  <span class="fu">plot_history</span><span class="op">(</span><span class="va">res</span>, x_value <span class="op">=</span> <span class="st">"total n"</span>, y_value <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Run multiple simulation with a fixed random base seed</span></span>
<span class="r-in">  <span class="co"># Notice that sparse = FALSE is required</span></span>
<span class="r-in">  <span class="va">res_mult</span> <span class="op">&lt;-</span> <span class="fu"><a href="run_trials.html">run_trials</a></span><span class="op">(</span><span class="va">binom_trial</span>, n_rep <span class="op">=</span> <span class="fl">15</span>, base_seed <span class="op">=</span> <span class="fl">12345</span>, sparse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Plot allocation probabilities at each look</span></span>
<span class="r-in">  <span class="fu">plot_history</span><span class="op">(</span><span class="va">res_mult</span>, x_value <span class="op">=</span> <span class="st">"look"</span>, y_value <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Other y_value options are available but not shown in these examples</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Do not return/print last plot in documentation</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Anders Granholm, Benjamin Skov Kaas-Hansen.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

    </footer></div>

  

  

  </body></html>

