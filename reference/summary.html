<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Summarises simulation results from the run_trials function. Uses
extract_results, which may be used directly to extract key trial results
without summarising."><title>Summary of simulated trial results — summary • adaptr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Summary of simulated trial results — summary"><meta property="og:description" content="Summarises simulation results from the run_trials function. Uses
extract_results, which may be used directly to extract key trial results
without summarising."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">adaptr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Advanced-example.html">Advanced example</a>
    <a class="dropdown-item" href="../articles/Basic-examples.html">Basic examples</a>
    <a class="dropdown-item" href="../articles/Overview.html">Overview</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/INCEPTdk/adaptr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Summary of simulated trial results</h1>
      <small class="dont-index">Source: <a href="https://github.com/INCEPTdk/adaptr/blob/HEAD/R/summary.R" class="external-link"><code>R/summary.R</code></a></small>
      <div class="d-none name"><code>summary.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Summarises simulation results from the <a href="run_trials.html">run_trials</a> function. Uses
<a href="extract_results.html">extract_results</a>, which may be used directly to extract key trial results
without summarising.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="co"># S3 method for trial_results</span>
<span class="fu">summary</span><span class="op">(</span>
  <span class="va">object</span>,
  select_strategy <span class="op">=</span> <span class="st">"control if available"</span>,
  select_last_arm <span class="op">=</span> <span class="cn">FALSE</span>,
  select_preferences <span class="op">=</span> <span class="cn">NULL</span>,
  te_comp <span class="op">=</span> <span class="cn">NULL</span>,
  raw_ests <span class="op">=</span> <span class="cn">FALSE</span>,
  restrict <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p><code>trial_results</code> object, output from the <a href="run_trials.html">run_trials</a> function.</p></dd>
<dt>select_strategy</dt>
<dd><p>single character string. For trials not stopped
due to superiority (or with only 1 arm remaining, if <code>select_last_arm</code> is
set to <code>TRUE</code> in trial designs with a common <code>control</code> arm; see below),
this parameter specifies which arm will be considered selected when
calculating trial design performance metrics (described below;
this corresponds to the consequence of an inconclusive trial, i.e., which
arm would then be used in practice).<br>
The following options are available and must be written exactly as below
(case sensitive, cannot be abbreviated):</p><ul><li><p><code>"control if available"</code> (default): selects the <strong>first</strong>
<code>control</code> arm for trials with a common control arm <em><strong>if</strong></em> this arm
is active at end-of-trial, otherwise no arm will be selected. For
trial designs without a common <code>control</code>, no arm will be selected.</p></li>
<li><p><code>"none"</code>: selects no arm in trials not ending with superiority.</p></li>
<li><p><code>"control"</code>: similar to <code>"control if available"</code>, but will throw
an error for trial designs without a common <code>control</code> arm.</p></li>
<li><p><code>"final control"</code>: selects the <strong>final</strong> <code>control</code> arm regardless
of whether the trial was stopped for practical equivalence, futility,
or at the maximum sample size; this strategy can only be specified
for trial designs with a common <code>control</code> arm.</p></li>
<li><p><code>"control or best"</code>: selects the <strong>first</strong> <code>control</code> arm if still
active at end-of-trial, otherwise selects the best remaining arm
(defined as the remaining arm with the highest probability of being
the best in the final analysis). Only works for trial designs with a
common <code>control</code> arm.</p></li>
<li><p><code>"best"</code>: selects the best remaining arm (as described under
<code>"control or best"</code>).</p></li>
<li><p><code>"list or best"</code>: selects the first remaining arm from a specified
list (specified using <code>select_preferences</code>, technically a character
vector). If none of these arms are are active at end-of-trial, the best
remaining arm will be selected (as described above).</p></li>
<li><p><code>"list"</code>: as specified above, but if no arms on the provided list
remain active at end-of-trial, no arm is selected.</p></li>
</ul></dd>
<dt>select_last_arm</dt>
<dd><p>single logical, defaults to <code>FALSE</code>. If <code>TRUE</code>, the
only remaining active arm (the last <code>control</code>) will be selected in trials
with a common <code>control</code> arm ending with <code>equivalence</code> or <code>futility</code>, before
considering the options specified in <code>select_strategy</code>. Must be <code>FALSE</code> for
trial designs without a common <code>control</code> arm.</p></dd>
<dt>select_preferences</dt>
<dd><p>character vector specifying a number of arms used
for selection if one of the <code>"list or best"</code> or <code>"list"</code> options are
specified for <code>select_strategy</code>. Can only contain valid <code>arms</code>
available in the trial.</p></dd>
<dt>te_comp</dt>
<dd><p>character string, treatment-effect comparator. Can be either
<code>NULL</code> (the default) in which case the <strong>first</strong> <code>control</code> arm is used for
trial designs with a common control arm, or a single trial <code>arm</code>. Will be
used when calculating <code>sq_err_te</code> (the squared error of the treatment
effect comparing the selected arm to the comparator arm, as described
below).</p></dd>
<dt>raw_ests</dt>
<dd><p>single logical. If <code>FALSE</code> (default), the
posterior estimates (<code>post_ests</code>, see <a href="setup_trial.html">setup_trial</a> and
<a href="run_trial.html">run_trial</a>) will be used to calculate <code>sq_err</code> (the squared error of the
estimated compared to the specified effect in the selected arm) and
<code>sq_err_te</code> (the squared error of the treatment effect comparing the
selected arm to the comparator arm, as described for <code>te_comp</code> and below).
If <code>TRUE</code>, the raw estimates (<code>raw_ests</code>, see <a href="setup_trial.html">setup_trial</a> and
<a href="run_trial.html">run_trial</a>) will be used instead of the posterior estimates.</p></dd>
<dt>restrict</dt>
<dd><p>single character string or <code>NULL</code>. If <code>NULL</code> (default),
results are summarised for all simulations; if <code>"superior</code>, results are
summarised for simulations ending with superiority only; if <code>"selected"</code>,
results are summarised for simulations ending with a selected arm
(according to the specified arm selection strategy for simulations not
ending with superiority). Some summary measures (e.g., <code>prob_conclusive</code>)
can only be calculated across all simulations and several are calculated
regardless of <code>restrict</code> settings, but have substantially different
interpretations if restricted.</p></dd>
<dt>...</dt>
<dd><p>additional arguments, not used.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>"trial_results_summary"</code> object containing the following:</p><ul><li><p><code>n_rep</code>: the number of simulations.</p></li>
<li><p><code>n_summarised</code>: the number of simulations summarised.</p></li>
<li><p><code>highest_is_best</code>: as specified in <a href="setup_trial.html">setup_trial</a>.</p></li>
<li><p><code>elapsed_time</code>: the total simulation time.</p></li>
<li><p><code>size_mean</code>, <code>size_sd</code>, <code>size_median</code>, <code>size_p25</code>, <code>size_p75</code>: the
mean, standard deviation, median as well as 25- and 75-percentiles of the
sample sizes of the summarised trial simulations.</p></li>
<li><p><code>sum_ys_mean</code>, <code>sum_ys_sd</code>, <code>sum_ys_median</code>, <code>sum_ys_p25</code>,
<code>sum_ys_p75</code>: the mean, standard deviation, median as well as 25- and
75-percentiles of the total <code>sum_ys</code> (e.g., the total number of events in
trials with a binary outcome, or the sums of continuous values for all
patients across all arms in trials with a continuous outcome) across all
arms in the summarised trial simulations.</p></li>
<li><p><code>ratio_ys_mean</code>, <code>ratio_ys_sd</code>, <code>ratio_ys_median</code>, <code>ratio_ys_p25</code>,
<code>ratio_ys_p75</code>: the mean, standard deviation, median as well as 25- and
75-percentiles of the final <code>ratio_ys</code> (<code>sum_ys/final_n</code>) across all arms
in the summarised trial simulations.</p></li>
<li><p><code>prob_conclusive</code>: the proportion of conclusive trial simulations
(simulations not stopped at the maximum sample size without a
superiority, equivalence or futility decision).</p></li>
<li><p><code>prob_superior</code>, <code>prob_equivalence</code>, <code>prob_futility</code>, <code>prob_max</code>: the
proportion (0-1) of trial simulations stopped for superiority,
equivalence, futility or inconclusive at the maximum allowed sample size,
respectively.</p></li>
<li><p><code>prob_select_*</code>: the selection probabilities for each arm and for no
selection, according to the specified selection strategy. Contains one
element per <code>arm</code>, named as <code>prob_select_arm_&lt;arm name&gt;</code> and
<code>prob_select_none</code> for the probability of selecting no arm.</p></li>
<li><p><code>rmse</code>, <code>rmse_te</code>: the root mean squared error of the estimates for
the selected arm and for the treatment effect, as described further in
<a href="extract_results.html">extract_results</a>.</p></li>
<li><p><code>idp</code>: the ideal design percentage (IDP; 0-100%), see <strong>Details</strong>.</p></li>
<li><p><code>select_strategy</code>, <code>select_last_arm</code>, <code>select_preferences</code>,
<code>te_comp</code>, <code>raw_ests</code>,<code>restrict</code>: as specified above.</p></li>
<li><p><code>control</code>: the control arm specified by <a href="setup_trial.html">setup_trial</a>,
<a href="setup_trial_binom.html">setup_trial_binom</a> or <a href="setup_trial_norm.html">setup_trial_norm</a>; <code>NULL</code> if no control.</p></li>
<li><p><code>equivalence_assessed</code>, <code>futility_assessed</code>: single logicals,
specifies whether the trial design specification includes assessments of
equivalence and/or futility.</p></li>
<li><p><code>base_seed</code>: as specified in <a href="run_trials.html">run_trials</a>.</p></li>
<li><p><code>cri_width</code>, <code>n_draws</code>, <code>robust</code>, <code>description</code>, <code>add_info</code>: as
specified in <a href="setup_trial.html">setup_trial</a>, <a href="setup_trial_binom.html">setup_trial_binom</a> or <a href="setup_trial_norm.html">setup_trial_norm</a>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The ideal design percentage (IDP) returned (described below) is based on
<em>Viele et al, 2020</em> doi: <a href="https://doi.org/10.1177/1740774519877836" class="external-link">10.1177/1740774519877836</a>
 and
has been adapted to work for trials with both desirable/undesirable outcomes
and non-binary outcomes. Briefly, the expected outcome is calculated as the
sum of the true outcomes in each arm multiplied by the corresponding
selection probabilities (ignoring simulations with no selected arm). The IDP
is then calculated as:</p><ul><li><p>For desirable outcomes:<br><code>100 * (expected outcome - lowest true outcome) / (highest true outcome - lowest true outcome)</code></p></li>
<li><p>For undesirable outcomes:<br><code>100 - IDP calculated for desirable outcomes</code></p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># Setup a trial specification</span></span>
<span class="r-in"><span class="va">binom_trial</span> <span class="op">&lt;-</span> <span class="fu"><a href="setup_trial_binom.html">setup_trial_binom</a></span><span class="op">(</span>arms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span><span class="op">)</span>,</span>
<span class="r-in">                                 control <span class="op">=</span> <span class="st">"A"</span>,</span>
<span class="r-in">                                 true_ys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.20</span>, <span class="fl">0.18</span>, <span class="fl">0.22</span>, <span class="fl">0.24</span><span class="op">)</span>,</span>
<span class="r-in">                                 data_looks <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Run 10 simulations with a specified random base seed</span></span>
<span class="r-in"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="run_trials.html">run_trials</a></span><span class="op">(</span><span class="va">binom_trial</span>, n_rep <span class="op">=</span> <span class="fl">10</span>, base_seed <span class="op">=</span> <span class="fl">12345</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Summarise simulations - select the control arm if available in trials not</span></span>
<span class="r-in"><span class="co"># ending with a superiority decision</span></span>
<span class="r-in"><span class="va">res_sum</span> <span class="op">&lt;-</span> <span class="fu">summary</span><span class="op">(</span><span class="va">res</span>, select_strategy <span class="op">=</span> <span class="st">"control"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Print summary</span></span>
<span class="r-in"><span class="fu"><a href="print.html">print</a></span><span class="op">(</span><span class="va">res_sum</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple simulation results: generic binomially distributed outcome trial</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Undesirable outcome</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Number of simulations: 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Number of simulations summarised: 10 (all trials)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Common control arm: A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Selection strategy: first control if available (otherwise no selection)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Treatment effect compared to: no comparison</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Performance metrics (using posterior estimates):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Sample sizes: mean 1720.0 (SD: 580.8) | median 2000.0 (IQR: 1775.0 to 2000.0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Total summarised outcomes: mean 338.6 (SD: 116.8) | median 387.5 (IQR: 334.2 to 396.8)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Total summarised outcome rates: mean 0.196 (SD: 0.007) | median 0.195 (IQR: 0.192 to 0.198)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Conclusive: 30.0%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Superiority: 30.0%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Equivalence: 0.0% [not assessed]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Futility: 0.0% [not assessed]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Inconclusive at max sample size: 70.0%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Selection probabilities: A: 60.0% | B: 30.0% | C: 0.0% | D: 0.0% | None: 10.0%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * RMSE: 0.03605</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * RMSE treatment effect: 0.12820</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Ideal design percentage: 77.8%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulation details:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Simulation time: 0.603 secs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Base random seed: 12345</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Credible interval width: 95%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Number of posterior draws: 5000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Estimation method: posterior medians with MAD-SDs</span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Anders Granholm, Benjamin Skov Kaas-Hansen.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

